# Fail2ban local configuration
# Generated by Ansible

[DEFAULT]
# Ban time (in seconds)
bantime = 3600

# Number of failures before ban
maxretry = 5

# Time window for failures (in seconds)
findtime = 600

# Email notifications
destemail = {{ vault_admin_email | default('root@localhost') }}
sendername = Fail2Ban
action = %(action_mwl)s

[sshd]
enabled = true
port = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s
maxretry = 3

[sshd-ddos]
enabled = true
port = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s

[caddy-auth]
enabled = true
port = http,https
logpath = /var/log/caddy/*.log
maxretry = 5
findtime = 600
bantime = 3600

[remember-me-api]
enabled = true
port = http,https
logpath = /var/log/remember-me/*.log
filter = remember-me-api
maxretry = 10
findtime = 300
bantime = 1800